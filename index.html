<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vaccine Mandate Decision Aid Tool</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <header class="text-center">
      <h1>Vaccine Mandate Decision Aid Tool</h1>
      <p>Explore how vaccine mandate policies affect public acceptance and costs using survey data from 322 people.</p>
    </header>
    <div class="instruction-banner card">
      <i class="fa-solid fa-circle-info info-icon" data-bs-toggle="tooltip" title="Follow these steps to use the tool"></i>
      <strong>How to Use:</strong> Choose settings in <em>Inputs</em>, adjust costs in <em>Costs & Benefits</em>, and click <em>Calculate</em> to see results. Save scenarios in <em>Scenarios</em> for comparison.
    </div>
    <nav class="tabs" role="tablist">
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="introTab-tab" data-bs-toggle="tab" data-bs-target="#introTab" type="button" role="tab" aria-controls="introTab" aria-selected="true">
            <i class="fa-solid fa-info-circle info-icon" data-bs-toggle="tooltip" title="Tool overview"></i> Introduction
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="attributesTab-tab" data-bs-toggle="tab" data-bs-target="#attributesTab" type="button" role="tab" aria-controls="attributesTab" aria-selected="false">
            <i class="fa-solid fa-list info-icon" data-bs-toggle="tooltip" title="Policy attributes"></i> Attributes
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="inputsTab-tab" data-bs-toggle="tab" data-bs-target="#inputsTab" type="button" role="tab" aria-controls="inputsTab" aria-selected="false">
            <i class="fa-solid fa-sliders info-icon" data-bs-toggle="tooltip" title="Configure policy"></i> Inputs
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="wtslTab-tab" data-bs-toggle="tab" data-bs-target="#wtslTab" type="button" role="tab" aria-controls="wtslTab" aria-selected="false">
            <i class="fa-solid fa-chart-bar info-icon" data-bs-toggle="tooltip" title="Willingness to save lives"></i> WTSL
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="probTab-tab" data-bs-toggle="tab" data-bs-target="#probTab" type="button" role="tab" aria-controls="probTab" aria-selected="false">
            <i class="fa-solid fa-chart-pie info-icon" data-bs-toggle="tooltip" title="Predicted acceptance"></i> Uptake
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="costsTab-tab" data-bs-toggle="tab" data-bs-target="#costsTab" type="button" role="tab" aria-controls="costsTab" aria-selected="false">
            <i class="fa-solid fa-calculator info-icon" data-bs-toggle="tooltip" title="Cost-benefit analysis"></i> Costs & Benefits
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="scenariosTab-tab" data-bs-toggle="tab" data-bs-target="#scenariosTab" type="button" role="tab" aria-controls="scenariosTab" aria-selected="false">
            <i class="fa-solid fa-folder-open info-icon" data-bs-toggle="tooltip" title="Saved scenarios"></i> Scenarios
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="glossaryTab-tab" data-bs-toggle="tab" data-bs-target="#glossaryTab" type="button" role="tab" aria-controls="glossaryTab" aria-selected="false">
            <i class="fa-solid fa-book info-icon" data-bs-toggle="tooltip" title="Key terms"></i> Glossary
          </button>
        </li>
      </ul>
    </nav>
    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade show active" id="introTab" role="tabpanel" aria-labelledby="introTab-tab">
        <div class="card">
          <h2>Introduction <i class="fa-solid fa-circle-info info-icon" data-bs-toggle="tooltip" title="What this tool does"></i></h2>
          <p>This tool helps you understand how different vaccine mandate policies might be received by the public and what their costs and benefits might be. It uses data from a survey of 322 people to predict acceptance rates and calculates costs and benefits based on realistic estimates.</p>
        </div>
      </div>
      <div class="tab-pane fade" id="attributesTab" role="tabpanel" aria-labelledby="attributesTab-tab">
        <h2>Key Policy Attributes <i class="fa-solid fa-circle-info info-icon" data-bs-toggle="tooltip" title="What each setting means"></i></h2>
        <div class="row">
          <div class="col-md-6">
            <div class="card attribute-card">
              <div class="attribute-icon"><i class="fa-solid fa-users"></i></div>
              <div class="attribute-content">
                <h4>Scope of the Mandate</h4>
                <p><strong>Default:</strong> High-risk occupations only (e.g., healthcare workers).</p>
                <p><strong>Alternative:</strong> All occupations and public spaces.</p>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card attribute-card">
              <div class="attribute-icon"><i class="fa-solid fa-user-shield"></i></div>
              <div class="attribute-content">
                <h4>Exemption Policy</h4>
                <p><strong>Default:</strong> Medical only.</p>
                <ul>
                  <li>Medical + religious</li>
                  <li>Medical, religious + broad personal beliefs</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card attribute-card">
              <div class="attribute-icon"><i class="fa-solid fa-percentage"></i></div>
              <div class="attribute-content">
                <h4>Vaccine Coverage Requirement</h4>
                <p><strong>Default:</strong> 50%</p>
                <p><strong>Alternatives:</strong> 70%, 90%</p>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card attribute-card">
              <div class="attribute-icon"><i class="fa-solid fa-heart-pulse"></i></div>
              <div class="attribute-content">
                <h4>Estimated Lives Saved</h4>
                <p>Number of lives saved per 100,000 population due to the mandate.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="inputsTab" role="tabpanel" aria-labelledby="inputsTab-tab">
        <div class="card">
          <h2>Configure Policy <i class="fa-solid fa-circle-info info-icon" data-bs-toggle="tooltip" title="Choose policy settings"></i></h2>
          <form>
            <div class="input-cards row">
              <div class="col-md-4 input-level-card">
                <h3>Country</h3>
                <select id="country_select" class="form-control" onchange="updateCostInputs()">
                  <option value="Australia">Australia</option>
                  <option value="France">France</option>
                  <option value="Italy">Italy</option>
                </select>
              </div>
              <div class="col-md-4 input-level-card">
                <h3>Outbreak Severity</h3>
                <p>(Pooled | Mild | Severe)</p>
                <select id="severitySelect" class="form-control">
                  <option value="pooled">Pooled</option>
                  <option value="mild">Mild</option>
                  <option value="severe">Severe</option>
                </select>
                <p class="small-text">Use pooled for overall data, mild for less severe outbreaks, severe for more severe.</p>
              </div>
              <div class="col-md-4 input-level-card">
                <h3>Scope</h3>
                <p>(Default: High-risk only)</p>
                <label><input type="radio" name="scope" value="all"> All occupations & public spaces</label>
              </div>
              <div class="col-md-4 input-level-card">
                <h3>Exemption</h3>
                <p>(Default: Medical only)</p>
                <label><input type="radio" name="exemption" value="medRel"> Medical + religious</label>
                <label><input type="radio" name="exemption" value="all"> Medical + religious + personal</label>
              </div>
              <div class="col-md-4 input-level-card">
                <h3>Coverage</h3>
                <p>(Default: 50%)</p>
                <label><input type="radio" name="coverage" value="70"> 70%</label>
                <label><input type="radio" name="coverage" value="90"> 90%</label>
              </div>
              <div class="col-md-4 input-level-card">
                <h3>Lives Saved</h3>
                <input type="range" id="livesSaved" min="10" max="40" step="5" value="25" class="form-range"
                       oninput="document.getElementById('livesSavedValue').textContent=this.value" />
                <p><strong><span id="livesSavedValue">25</span></strong> per 100,000</p>
                <p class="small-text">Move the slider to adjust the lives saved estimate.</p>
              </div>
              <div class="col-md-4 input-level-card">
                <h3>Preset Scenarios</h3>
                <button type="button" class="btn btn-secondary mb-2" onclick="loadPreset('current')">Current Policy</button>
                <button type="button" class="btn btn-secondary mb-2" onclick="loadPreset('expanded')">Expanded Mandate</button>
                <button type="button" class="btn btn-secondary mb-2" onclick="loadPreset('relaxed')">Relaxed Exemptions</button>
              </div>
            </div>
            <div class="buttons-row mt-3">
              <button type="button" class="btn btn-secondary" onclick="resetInputs()">Reset</button>
              <button type="button" class="btn btn-primary" onclick="calculateScenario()">Calculate & View Results</button>
            </div>
          </form>
          <div class="modal fade" id="resultModal" tabindex="-1" aria-labelledby="resultModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="resultModalLabel">Scenario Results</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div id="modalResults"></div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="wtslTab" role="tabpanel" aria-labelledby="wtslTab-tab">
        <div class="card">
          <h4>Willingness to Save Lives (WTSL) <i class="fa-solid fa-circle-info info-icon" data-bs-toggle="tooltip" title="How many lives per 100k are needed to offset policy changes"></i></h4>
          <p>Shows how many lives must be saved to justify changes in policy settings. Select a severity level to view results.</p>
          <canvas id="wtslChart" class="chart-box"></canvas>
          <div id="wtslInfo"></div>
        </div>
      </div>
      <div class="tab-pane fade" id="probTab" role="tabpanel" aria-labelledby="probTab-tab">
        <div class="card">
          <h4>Predicted Uptake <i class="fa-solid fa-circle-info info-icon" data-bs-toggle="tooltip" title="Percentage of people likely to accept the vaccine"></i></h4>
          <p>Estimates the percentage of people who would accept the vaccine based on your policy settings. Calculate a scenario to see results.</p>
          <div class="progress mt-3">
            <div id="uptakeBar" class="progress-bar bg-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
          </div>
          <button onclick="showUptakeRecommendations()" class="btn btn-primary mt-3">Dynamic Recommendations</button>
        </div>
        <div class="modal fade" id="uptakeModal" tabindex="-1" aria-labelledby="uptakeModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="uptakeModalLabel">Uptake Recommendations</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div id="uptakeResults"></div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="costsTab" role="tabpanel" aria-labelledby="costsTab-tab">
        <div class="card">
          <h4>Cost–Benefit Analysis <i class="fa-solid fa-circle-info info-icon" data-bs-toggle="tooltip" title="Detailed breakdown of costs and benefits"></i></h4>
          <p>Compares the costs of implementing the mandate to the health benefits, measured in Quality-Adjusted Life Years (QALYs). Calculate a scenario to see results.</p>
          <div class="row">
            <div class="col-md-6">
              <h5>Cost Parameters (Optional: adjust for custom analysis)</h5>
              <div class="form-group mb-3">
                <label for="fixed_vaccineProcurement">Vaccine Procurement (fixed)</label>
                <input type="number" id="fixed_vaccineProcurement" class="form-control" value="80000">
              </div>
              <div class="form-group mb-3">
                <label for="fixed_administration">Administration & Staffing</label>
                <input type="number" id="fixed_administration" class="form-control" value="30000">
              </div>
              <div class="form-group mb-3">
                <label for="fixed_legal">Legal & Compliance</label>
                <input type="number" id="fixed_legal" class="form-control" value="10000">
              </div>
              <div class="form-group mb-3">
                <label for="fixed_communication">Communication & Outreach</label>
                <input type="number" id="fixed_communication" class="form-control" value="15000">
              </div>
              <div class="form-group mb-3">
                <label for="fixed_monitoring">Monitoring & Data Systems</label>
                <input type="number" id="fixed_monitoring" class="form-control" value="20000">
              </div>
              <div class="form-group mb-3">
                <label for="variablePerPerson">Variable Cost per Person</label>
                <input type="number" id="variablePerPerson" class="form-control" value="40">
              </div>
            </div>
            <div class="col-md-6">
              <h5>Benefit Scenario (Value per QALY)</h5>
              <select id="benefitScenario" class="form-control mb-3" onchange="updateAll()">
                <option value="low">Low (A$40k / €35k)</option>
                <option value="medium" selected>Medium (A$50k / €45k)</option>
                <option value="high">High (A$60k / €55k)</option>
              </select>
              <h5>Cost of Living Adjustment</h5>
              <select id="adjustCOL" class="form-control mb-3" onchange="updateAll()">
                <option value="yes">Yes</option>
                <option value="no" selected>No</option>
              </select>
            </div>
          </div>
          <div id="costsBenefitsResults"></div>
          <canvas id="costBenefitChart" class="chart-box"></canvas>
          <canvas id="netBenefitChart" class="chart-box"></canvas>
          <div class="mermaid mt-3">
            graph TD
              A[Policy Decision] --> B{ Scope: High-risk or All? }
              B -->|High-risk| C[Exemption: Medical only]
              B -->|All| D[Exemption: Medical + Religious]
              C --> E[Coverage: 50%]
              D --> F[Coverage: 70%]
              E --> G[Lives Saved: 25]
              F --> H[Lives Saved: 30]
              G --> I[Uptake: Calculate]
              H --> J[Uptake: Calculate]
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="scenariosTab" role="tabpanel" aria-labelledby="scenariosTab-tab">
        <div class="card">
          <h4>Saved Scenarios <i class="fa-solid fa-circle-info info-icon" data-bs-toggle="tooltip" title="Review and export saved configurations"></i></h4>
          <p>Save and compare different policy scenarios to see their impacts.</p>
          <button onclick="saveScenario()" class="btn btn-primary me-2">Save Scenario</button>
          <button onclick="openComparison()" class="btn btn-secondary me-2">Compare & Export PDF</button>
          <button onclick="downloadCSV()" class="btn btn-secondary">Download CSV</button>
          <div class="table-responsive mt-3">
            <table id="scenarioTable" class="table table-striped">
              <thead>
                <tr>
                  <th>Name</th><th>Severity</th><th>Scope</th><th>Exemption</th><th>Coverage</th>
                  <th>Lives</th><th>Uptake%</th><th>Net Benefit</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="glossaryTab" role="tabpanel" aria-labelledby="glossaryTab-tab">
        <div class="card">
          <h2>Glossary <i class="fa-solid fa-circle-info info-icon" data-bs-toggle="tooltip" title="Key terms explained"></i></h2>
          <ul>
            <li><strong>QALY (Quality-Adjusted Life Year):</strong> A measure of health benefits, combining life expectancy and quality of life.</li>
            <li><strong>WTSL (Willingness to Save Lives):</strong> The number of lives needed to justify a policy change.</li>
            <li><strong>Fixed Costs:</strong> One-time expenses like legal fees or communication campaigns.</li>
            <li><strong>Variable Costs:</strong> Costs per vaccinated person, like time lost or testing.</li>
            <li><strong>Uptake Probability:</strong> The predicted percentage of people who would accept the vaccine.</li>
          </ul>
        </div>
      </div>
    </div>
    <footer class="text-center mt-4">
      <p>© 2025 Vaccine Mandate Decision Aid Tool</p>
    </footer>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
